$json = Get-Content "original.json" | ConvertFrom-Json

$newQHyperCubeDef = @{
    "qDimensions" = Import-Csv "qDimensions.csv" | ForEach-Object {
        $_.psobject.Properties | ForEach-Object {
            @{ $_.Name = $_.Value }
        }
    }
    "qMeasures" = Import-Csv "qMeasures.csv" | ForEach-Object {
        $_.psobject.Properties | ForEach-Object {
            @{ $_.Name = $_.Value }
        }
    }
    $json.qHyperCubeDef.psobject.Properties | ForEach-Object {
        $_.Name = $_.Value
    }
}

$newJson = @{
    $json.psobject.Properties | ForEach-Object {
        $_.Name = if($_.Name -eq "qHyperCubeDef") { "qHyperCubeDef" } else { $_.Name }
        @{ $_.Name = $_.Value }
    }
}

Set-Content -Path "new.json" -Value ($newJson | ConvertTo-Json)
