#6 Add the dimensions to the Qlik Sense table properties
$newTableProperties.qHyperCubeDef.qDimensions = foreach ($dimension in $dimensions) {
    $dimensionProperties | Select-Object * | ForEach-Object {
        $_.qDef.qFieldDefs = @($dimension.qFieldDefs)
        $_
    }
}

#7 Add the measures to the Qlik Sense table properties
$newTableProperties.qHyperCubeDef.qMeasures = foreach ($measure in $measures) {
    $measureProperties | Select-Object * | ForEach-Object {
        $_.qDef.qDef = $measure.qDef
        $_
    }
}
