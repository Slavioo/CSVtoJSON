#6 Add the dimensions to the Qlik Sense table properties
foreach ($dimension in $dimensions) {

  $qDimension = $dimensionProperties | Select-Object *

  # split the qFieldDefs string into an array of field names
  $fieldDefs = $dimension.qFieldDefs -split "," | ForEach-Object { $_.Trim() }

  # set qFieldDefs to the array of field names
  $qDimension.qDef.qFieldDefs = $fieldDefs

  $newTableProperties.qHyperCubeDef.qDimensions += $qDimension

}
